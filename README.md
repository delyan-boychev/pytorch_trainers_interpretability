# Pytorch Trainers and Interpretability Evaluators

_(Increasing Computer Vision Models Interpretability)_

Contact: delyan.boychev05@gmail.com

With the perpetual increase of complexity of the state-of-the-art deep neural networks, it becomes more and more challenging to maintain their transparency. Our work aims to evaluate the effects of adversarial training utilized to produce robust models. Moreover, it has been shown to make computer vision models more explainable. Interpretability is as essential as robustness when we deploy the models to the real world. To prove there is a correlation between these two problems as well as determine the quality of the learned representations, we extensively examine the models using local feature-importance methods (SHAP, Integrated Gradients) and feature visualization techniques (Representation Inversion, Class Specific Image Generation).
Standard models, compared to robust ones are less secure, and their learned representations are less meaningful to humans. Controversially, robust models focus on distinctive regions of the images which support their predictions.

## Small ImageNet 150

Small ImageNet 150 dataset can be found [here](https://drive.google.com/file/d/1_nc-VVObGiOoS73gEH-UhVUsIytU0YRK/view?usp=sharing) and its labels [here](https://drive.google.com/file/d/1t71KG_u-X-LCAFJ94Kg0pqNBajumEEsu/view?usp=sharing). Each class consists of 600 images for training and 50 images for validation. The training size is 90000 images and validation-7500 images. The test size is 9000 images. The total size of the dataset is 106500 128x128 RGB images. These images are not as small as CIFAR10 images and we can analyze modelsâ€™ interpretability much deeper and also achieve high performance. This subset which we call Small ImageNet 150 is generated by randomly picking classes and images.

## Checkpoints

### CIFAR10

The architecture of the model which is used is ResNet18. The models are evalutated on $l_2$ (constraint $\varepsilon = 0.5$ and step size $\sigma = 0.1$) adversaries generated with PGD for 20 iterations.
| **Model** | **Standard Accuracy** | **$l_{2}$ Accuracy** | **Checkpoint** |
|-----------------------------------|-----------------------|----------------------|-----------------------------------------------------------------------------------------------|
| Standard model | **93.2** | 0.36| [here](https://drive.google.com/file/d/1--6YSHDUNcwXvnjUgjdOcV_A3bMcHEbD/view?usp=sharing) |
| Robust $l_{2}$ trained model | 85 | **64.6** | [here](https://drive.google.com/file/d/1OcvlvVlsC1oMIzZedvf3Zh6Q10kKzoyN/view?usp=sharing) |

### Small ImageNet 150

The architecture of the model which is used is ResNet50. The models are evalutated on $l_2$ (constraint $\varepsilon = 1.5$ and step size $\sigma = 2.5*1.5/20$) adversaries generated with PGD for 20 iterations.

| **Model**                    | **Standard Accuracy** | **$l_{2}$ Accuracy** | **Checkpoint**                                                                             |
| ---------------------------- | --------------------- | -------------------- | ------------------------------------------------------------------------------------------ |
| Standard model               | **70.1**              | 0.88                 | [here](https://drive.google.com/file/d/1s4N-Nxn_yZGPSedptrD7qktHlTtTCFMi/view?usp=sharing) |
| Robust $l_{2}$ trained model | 55.8                  | **35.4**             | [here](https://drive.google.com/file/d/1kg_Lshu5pY8L2HqeCMMqxmdZTTetaIIC/view?usp=sharing) |

## Examples

| **Dataset**        | **Training**                                 | **Interpretability**                                    |
| ------------------ | -------------------------------------------- | ------------------------------------------------------- |
| CIFAR10            | [here](./examples/cifar10_train.ipynb)       | [here](./examples/cifar10_interpretability.ipynb)       |
| Small ImageNet 150 | [here](./examples/smallimagenet_train.ipynb) | [here](./examples/smallimagenet_interpretability.ipynb) |

## CIFAR-10 Models Training

![](https://github.com/delyan-boychev/pytorch_trainers_interpretability/blob/master/images/cifar10/training/standard_acc.png?raw=true)
![](https://github.com/delyan-boychev/pytorch_trainers_interpretability/blob/master/images/cifar10/training/standard_loss.png?raw=true)
![](https://github.com/delyan-boychev/pytorch_trainers_interpretability/blob/master/images/cifar10/training/robust_acc.png?raw=true)
![](https://github.com/delyan-boychev/pytorch_trainers_interpretability/blob/master/images/cifar10/training/robust_loss.png?raw=true)

## Small ImageNet 150 Models Training

![](https://github.com/delyan-boychev/pytorch_trainers_interpretability/blob/master/images/smimagenet/training/standard_acc.png?raw=true)
![](https://github.com/delyan-boychev/pytorch_trainers_interpretability/blob/master/images/smimagenet/training/standard_loss.png?raw=true)
![](https://github.com/delyan-boychev/pytorch_trainers_interpretability/blob/master/images/smimagenet/training/robust_acc.png?raw=true)
![](https://github.com/delyan-boychev/pytorch_trainers_interpretability/blob/master/images/smimagenet/training/robust_loss.png?raw=true)
